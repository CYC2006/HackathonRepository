@page "/cards"
@using Hackathon.Data
@inject Hackathon.Data.GameState Game

<h2 style="text-align:center; font-size:2.2rem; margin-top:30px; margin-bottom:30px;">
    ğŸ´ Collected Cards ğŸ´
</h2>


<h2 id="region" style="text-align:left;">ğŸƒ Regional Cards</h2>
@if (Game.CollectedCards.Count == 0)
{
    <h4 style="text-align:center; margin-top:20px;">----- No Card Collected -----</h4>
}
else
{
    <div class="card-gallery">
        @foreach (var card in Game.CollectedCards)
        {
            <div class="card-item rarity-bg-@card.Rarity">
                <div class="card-title">@card.Title</div>
                <div class="card-meta">
                    <span class="card-city">@card.City</span>
                    <span class="card-rarity rarity-@card.Rarity">@card.Rarity</span>
                </div>
                @if (!string.IsNullOrEmpty(card.ImagePath))
                {
                    <img src="@card.ImagePath" alt="@card.Title" class="card-image" />
                }
                else
                {
                    <div class="card-image"></div>
                }
                <div class="card-stats">
                    <div>ğŸ’° @card.MoneyChange ğŸŒ¿ @card.EcoChange ğŸ›ï¸ @card.SocialChange</div>
                </div>
                <div class="card-desc">@card.Description</div>
            </div>
        }
    </div>
}


<h2 id="sustain" style="text-align:left;">ğŸƒ Sustain Cards</h2>

@if (Game.OngoingEffects.Count == 0)
{
    <h4 style="text-align:center; margin-top:20px;">----- No Ongoing Cards -----</h4>
}
else
{
    <div class="card-gallery">
        @foreach (var e in Game.OngoingEffects)
        {
            CardInfo? baseCard = null;

            // ğŸ” è‡ªå‹•æœå°‹æ‰€æœ‰åŸå¸‚çš„å¡ç‰‡è³‡æ–™
            foreach (var city in CardDESC.Title.Keys)
            {
                var found = CardData.GetCardsForCity(city)
                                    .FirstOrDefault(c => c.Title == e.Title);
                if (found is not null)
                {
                    baseCard = found;
                    break;
                }
            }

            if (baseCard is not null)
            {
                <div class="card-item rarity-bg-@baseCard.Rarity">
                    <div class="card-title">@baseCard.Title</div>
                    <div class="card-meta">
                        <span class="card-city">@baseCard.City</span>
                        <span class="card-rarity rarity-@baseCard.Rarity">@baseCard.Rarity</span>
                    </div>

                    @if (!string.IsNullOrEmpty(baseCard.ImagePath))
                    {
                        <img src="@baseCard.ImagePath" alt="@baseCard.Title" class="card-image" />
                    }
                    else
                    {
                        <div class="card-image"></div>
                    }

                    <div class="card-stats">
                        <div>ğŸ’° @baseCard.MoneyChange ğŸŒ¿ @baseCard.EcoChange ğŸ›ï¸ @baseCard.SocialChange</div>
                    </div>
                    <div class="card-desc">@baseCard.Description</div>
                </div>
            }
        }
    </div>
}


<h2 id="other" style="text-align:left;">ğŸƒ Event Cards</h2>