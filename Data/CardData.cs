using System.Collections.Generic;

namespace Hackathon.Data
{
    public class CardInfo
    {
        public string Title { get; set; } = "";
        public string Description { get; set; } = "";  // 敘述
        public int MoneyChange { get; set; }           // 金錢變動量
        public int EcoChange { get; set; }             // 環保評分變動量
        public int SocialChange { get; set; }          // 社會觀感變動量
        public string ColorTag { get; set; } = "green"; // background color
        public string? ImagePath { get; set; } = null; // image path
        public string Rarity { get; set; } = "N";
        public string City { get; set; } = "";

        // 保留 Clone（相容舊用法）
        public CardInfo Clone()
        {
            return new CardInfo
            {
                Title = this.Title,
                Description = this.Description,
                MoneyChange = this.MoneyChange,
                EcoChange = this.EcoChange,
                SocialChange = this.SocialChange,
                ColorTag = this.ColorTag,
                ImagePath = this.ImagePath,
                City = this.City,
                Rarity = this.Rarity
            };
        }
    }
    
    public static class CardData
    {
        public record Row(string City, int Index, int Money, int Eco, int Social, string Rarity, string ImagePath);

        private static readonly Row[] Rows = new Row[]
        {
            new Row("台南", 0, 5, 20, 15, "SR", " "),
            new Row("台南", 1, 0, 15, 10, "R", " "),
            new Row("台南", 2, 5, 10, 5, "N", " "),
            new Row("台南", 3, 0, 10, 5, "N", " "),
            new Row("台南", 4, -10, -20, -15, "SR", " "),
            new Row("台南", 5, -5, -15, -10, "R", " "),
            new Row("台南", 6, 0, -10, -5, "N", " "),
            new Row("台南", 7, 0, -15, -10, "R", " "),
            new Row("台南", 8, 20, -15, -5, "SR", " "),
            new Row("台南", 9, 15, -10, -5, "R", " "),
            new Row("台南", 10, 15, -5, 5, "R", " "),
            new Row("台南", 11, 10, -5, 5, "N", " "),
            new Row("台南", 12, 50, -5, 30, "UR", " "),
            new Row("台南", 13, 30, -5, 25, "SSR", " "),
            new Row("台南", 14, -1, 0, 3, "N", " "),
            new Row("南投", 0, 5, 15, 10, "R", " "),
            new Row("南投", 1, 0, 20, 5, "SR", " "),
            new Row("南投", 2, 5, 10, 5, "N", " "),
            new Row("南投", 3, 0, 15, 5, "R", " "),
            new Row("南投", 4, -5, -25, -15, "SSR", " "),
            new Row("南投", 5, 0, -20, -10, "SR", " "),
            new Row("南投", 6, 0, -15, -10, "R", " "),
            new Row("南投", 7, 5, -10, -5, "N", " "),
            new Row("南投", 8, 15, -10, -5, "R", " "),
            new Row("南投", 9, 10, -5, 5, "N", " "),
            new Row("南投", 10, 20, -15, -10, "SR", " "),
            new Row("南投", 11, 10, -5, 5, "N", " "),
            new Row("南投", 12, 45, 15, 30, "UR", " "),
            new Row("台中", 0, 10, 15, 10, "R", " "),
            new Row("台中", 1, 0, 10, 10, "N", " "),
            new Row("台中", 2, 5, 15, 5, "R", " "),
            new Row("台中", 3, 0, 10, 5, "N", " "),
            new Row("台中", 4, -10, -25, -20, "SSR", " "),
            new Row("台中", 5, 0, -15, -10, "R", " "),
            new Row("台中", 6, -5, -20, -15, "SR", " "),
            new Row("台中", 7, 0, -15, -10, "R", " "),
            new Row("台中", 8, 20, -15, -5, "SR", " "),
            new Row("台中", 9, 15, -5, 5, "R", " "),
            new Row("台中", 10, 15, -10, 5, "R", " "),
            new Row("台中", 11, 10, -5, 10, "N", " "),
            new Row("台中", 12, 50, -10, 30, "UR", " "),
            new Row("台中", 13, -1, 0, 2, "N", " "),
            new Row("台北", 0, 0, 15, 10, "R", " "),
            new Row("台北", 1, 0, 10, 10, "R", " "),
            new Row("台北", 2, 0, 20, 5, "SR", " "),
            new Row("台北", 3, 0, 15, 5, "R", " "),
            new Row("台北", 4, -10, -15, -10, "R", " "),
            new Row("台北", 5, 0, -10, -15, "R", " "),
            new Row("台北", 6, -5, -15, -5, "R", " "),
            new Row("台北", 7, 0, -20, -10, "SR", " "),
            new Row("台北", 8, 25, -15, 5, "SSR", " "),
            new Row("台北", 9, 20, -5, 10, "SR", " "),
            new Row("台北", 10, 15, -10, -5, "R", " "),
            new Row("台北", 11, 10, -5, 10, "R", " "),
            new Row("台北", 12, 50, 10, 30, "UR", " "),
            new Row("台北", 13, -1, 0, 1, "N", " "),
            new Row("台北", 14, -1, 0, 2, "N", " "),
            new Row("台北", 15, 15, -5, 10, "SR", " "),
            new Row("台北", 16, 5, -5, 10, "R", " "),
            new Row("台北", 17, 10, -5, 5, "R", " "),
            new Row("台北", 18, 15, -5, 10, "SR", " "),
            new Row("台東", 0, 15, 15, 10, "R", " "),
            new Row("台東", 1, 10, 10, 5, "R", " "),
            new Row("台東", 2, 5, 20, 5, "SR", " "),
            new Row("台東", 3, 0, 10, 15, "R", " "),
            new Row("台東", 4, 0, -25, -20, "SSR", " "),
            new Row("台東", 5, 5, -20, -10, "SR", " "),
            new Row("台東", 6, 5, -10, -5, "N", " "),
            new Row("台東", 7, -10, -15, 0, "R", " "),
            new Row("台東", 8, 20, -5, 10, "SR", " "),
            new Row("台東", 9, 15, -10, 5, "R", " "),
            new Row("台東", 10, 10, -5, 5, "N", " "),
            new Row("台東", 11, 15, -20, -15, "SR", " "),
            new Row("台東", 12, 45, 5, 30, "UR", " "),
            new Row("台東", 13, 0, 1, 2, "N", " "),
            new Row("台東", 14, 10, 0, 15, "SR", " "),
            new Row("台東", 15, 10, -10, 10, "SR", " "),
            new Row("台東", 16, 5, -5, 5, "R", " "),
            new Row("台東", 17, 10, -5, 10, "SR", " "),
            new Row("嘉義", 0, 0, 15, 10, "R", " "),
            new Row("嘉義", 1, 0, 10, 5, "N", " "),
            new Row("嘉義", 2, 0, 10, 5, "N", " "),
            new Row("嘉義", 3, -5, -15, -10, "R", " "),
            new Row("嘉義", 4, -5, -15, -10, "R", " "),
            new Row("嘉義", 5, 15, -5, 5, "R", " "),
            new Row("嘉義", 6, 20, -10, -5, "SR", " "),
            new Row("嘉義", 7, 15, -10, -5, "R", " "),
            new Row("嘉義", 8, 40, 5, 30, "UR", " "),
            new Row("嘉義", 9, -20, -10, -30, "SSR", " "),
            new Row("嘉義", 10, -1, 0, 2, "N", " "),
            new Row("嘉義", 11, 20, -10, 15, "SR", " "),
            new Row("嘉義", 12, 15, -5, 5, "R", " "),
            new Row("嘉義", 13, 10, -3, 15, "R", " "),
            new Row("嘉義", 14, 5, -10, -5, "R", " "),
            new Row("嘉義", 15, -15, -5, -20, "SR", " "),
            new Row("嘉義", 16, 20, -10, 5, "SR", " "),
            new Row("基隆", 0, 15, 20, 10, "SR", " "),
            new Row("基隆", 1, 0, 15, 10, "R", " "),
            new Row("基隆", 2, 5, 10, 5, "R", " "),
            new Row("基隆", 3, 0, 15, 5, "R", " "),
            new Row("基隆", 4, 0, -25, -15, "SSR", " "),
            new Row("基隆", 5, 0, -20, -10, "SR", " "),
            new Row("基隆", 6, -5, -15, -5, "R", " "),
            new Row("基隆", 7, 5, -10, -5, "R", " "),
            new Row("基隆", 8, 25, -20, 0, "SSR", " "),
            new Row("基隆", 9, 15, -5, 5, "R", " "),
            new Row("基隆", 10, 20, -10, -5, "SR", " "),
            new Row("基隆", 11, 10, -5, 10, "R", " "),
            new Row("基隆", 12, 50, -5, 30, "UR", " "),
            new Row("基隆", 13, 0, 0, -1, "N", " "),
            new Row("基隆", 14, -1, 0, 2, "N", " "),
            new Row("基隆", 15, 10, 0, 10, "R", " "),
            new Row("基隆", 16, 15, -10, 10, "SR", " "),
            new Row("基隆", 17, 5, 0, 5, "N", " "),
            new Row("基隆", 18, -5, 5, 5, "R", " "),
            new Row("宜蘭", 0, 0, 30, 30, "UR", " "),
            new Row("宜蘭", 1, 0, 5, 5, "R", " "),
            new Row("宜蘭", 2, 0, 10, 10, "SR", " "),
            new Row("宜蘭", 3, -5, 15, 0, "R", " "),
            new Row("宜蘭", 4, 0, -20, -15, "N", " "),
            new Row("宜蘭", 5, -10, -25, 0, "N", " "),
            new Row("宜蘭", 6, 10, -10, -5, "N", " "),
            new Row("宜蘭", 7, 0, -15, -10, "N", " "),
            new Row("宜蘭", 8, 15, 10, -5, "SSR", " "),
            new Row("宜蘭", 9, 10, -5, -5, "N", " "),
            new Row("宜蘭", 10, 15, -5, 5, "R", " "),
            new Row("宜蘭", 11, 20, -10, 5, "R", " "),
            new Row("宜蘭", 12, 10, -5, 10, "R", " "),
            new Row("宜蘭", 13, 15, -10, 10, "UR", " "),
            new Row("宜蘭", 14, 5, -5, 5, "R", " "),
            new Row("宜蘭", 15, 10, -10, 5, "SR", " "),
            new Row("屏東", 0, 5, 20, 10, "SR", " "),
            new Row("屏東", 1, 5, 20, 15, "SR", " "),
            new Row("屏東", 2, 5, 10, 5, "N", " "),
            new Row("屏東", 3, 0, 10, 5, "N", " "),
            new Row("屏東", 4, -10, -25, -20, "SSR", " "),
            new Row("屏東", 5, -5, -20, -10, "SR", " "),
            new Row("屏東", 6, 5, -15, -10, "R", " "),
            new Row("屏東", 7, 0, -15, -5, "R", " "),
            new Row("屏東", 8, 15, -15, -5, "R", " "),
            new Row("屏東", 9, 10, -5, 5, "N", " "),
            new Row("屏東", 10, 10, -5, 5, "N", " "),
            new Row("屏東", 11, 15, -10, 5, "R", " "),
            new Row("屏東", 12, 40, -5, 30, "UR", " "),
            new Row("屏東", 13, -1, 0, 2, "N", " "),
            new Row("彰化", 0, 5, 15, 5, "R", " "),
            new Row("彰化", 1, 0, 10, 10, "N", " "),
            new Row("彰化", 2, 0, 15, 5, "R", " "),
            new Row("彰化", 3, 5, 10, 5, "N", " "),
            new Row("彰化", 4, -10, -25, -20, "SSR", " "),
            new Row("彰化", 5, -5, -20, -10, "SR", " "),
            new Row("彰化", 6, 0, -15, -5, "R", " "),
            new Row("彰化", 7, -5, -10, -5, "N", " "),
            new Row("彰化", 8, 15, -10, -5, "R", " "),
            new Row("彰化", 9, 10, -10, 5, "N", " "),
            new Row("彰化", 10, 15, -15, -5, "R", " "),
            new Row("彰化", 11, 10, -5, 5, "N", " "),
            new Row("彰化", 12, 45, -5, 25, "UR", " "),
            new Row("彰化", 13, -1, 0, 2, "N", " "),
            new Row("新北", 0, 10, 15, 10, "R", " "),
            new Row("新北", 1, 0, 10, 10, "R", " "),
            new Row("新北", 2, 5, 15, 5, "R", " "),
            new Row("新北", 3, 0, 10, 5, "R", " "),
            new Row("新北", 4, -10, -20, -15, "SR", " "),
            new Row("新北", 5, -5, -15, -10, "R", " "),
            new Row("新北", 6, 5, -10, -5, "R", " "),
            new Row("新北", 7, 0, -15, -10, "R", " "),
            new Row("新北", 8, 20, -15, -5, "SR", " "),
            new Row("新北", 9, 15, -5, 5, "R", " "),
            new Row("新北", 10, 20, -10, -5, "SR", " "),
            new Row("新北", 11, 10, -5, 5, "R", " "),
            new Row("新北", 12, 40, -10, 25, "UR", " "),
            new Row("新北", 13, -20, -5, -25, "SSR", " "),
            new Row("新北", 14, -1, 0, -1, "N", " "),
            new Row("新北", 15, -1, -1, 2, "N", " "),
            new Row("新北", 16, 10, -5, 10, "R", " "),
            new Row("新北", 17, 5, -10, 5, "R", " "),
            new Row("新北", 18, 10, 0, 10, "SR", " "),
            new Row("新北", 19, -5, 5, 5, "R", " "),
            new Row("新竹", 0, 5, 10, 10, "N", " "),
            new Row("新竹", 1, 0, 15, 5, "R", " "),
            new Row("新竹", 2, 0, 10, 5, "N", " "),
            new Row("新竹", 3, 5, 10, 5, "N", " "),
            new Row("新竹", 4, -10, -20, -10, "SR", " "),
            new Row("新竹", 5, 0, -15, -15, "R", " "),
            new Row("新竹", 6, 0, -10, -5, "N", " "),
            new Row("新竹", 7, 0, -15, -10, "R", " "),
            new Row("新竹", 8, 25, -15, -5, "SSR", " "),
            new Row("新竹", 9, 15, -5, 5, "R", " "),
            new Row("新竹", 10, 10, -5, -5, "N", " "),
            new Row("新竹", 11, 5, -10, 10, "N", " "),
            new Row("新竹", 12, 50, -5, 30, "UR", " "),
            new Row("新竹", 13, -1, 0, -1, "N", " "),
            new Row("桃園", 0, 10, 15, 10, "R", " "),
            new Row("桃園", 1, 5, 10, 5, "N", " "),
            new Row("桃園", 2, 0, 15, 5, "R", " "),
            new Row("桃園", 3, 0, 10, 10, "N", " "),
            new Row("桃園", 4, -5, -25, -15, "SSR", " "),
            new Row("桃園", 5, -10, -20, -10, "SR", " "),
            new Row("桃園", 6, 5, -10, -5, "N", " "),
            new Row("桃園", 7, 0, -15, -10, "R", " "),
            new Row("桃園", 8, 25, -15, -5, "SSR", " "),
            new Row("桃園", 9, 20, -10, 5, "SR", " "),
            new Row("桃園", 10, 15, -5, 5, "R", " "),
            new Row("桃園", 11, 5, -5, -5, "N", " "),
            new Row("桃園", 12, 40, 5, 30, "UR", " "),
            new Row("桃園", 13, -3, 0, 2, "N", " "),
            new Row("澎湖", 0, 5, 20, 10, "SR", " "),
            new Row("澎湖", 1, 0, 15, 5, "R", " "),
            new Row("澎湖", 2, 0, 10, 5, "N", " "),
            new Row("澎湖", 3, 0, 15, 5, "R", " "),
            new Row("澎湖", 4, -5, -25, -15, "SSR", " "),
            new Row("澎湖", 5, 0, -20, -10, "SR", " "),
            new Row("澎湖", 6, -5, -15, -5, "R", " "),
            new Row("澎湖", 7, 0, -10, -5, "N", " "),
            new Row("澎湖", 8, 15, -10, -15, "R", " "),
            new Row("澎湖", 9, 10, -5, 5, "N", " "),
            new Row("澎湖", 10, 15, -5, -5, "R", " "),
            new Row("澎湖", 11, 10, -10, 5, "N", " "),
            new Row("澎湖", 12, 50, -5, 35, "UR", " "),
            new Row("澎湖", 13, 30, -10, 25, "SSR", " "),
            new Row("澎湖", 14, -1, 0, 2, "N", " "),
            new Row("花蓮", 0, 15, 15, 5, "R", " "),
            new Row("花蓮", 1, 20, 20, 10, "SR", " "),
            new Row("花蓮", 2, 10, 10, 5, "R", " "),
            new Row("花蓮", 3, 0, 15, 15, "R", " "),
            new Row("花蓮", 4, 5, -20, -15, "SR", " "),
            new Row("花蓮", 5, 0, -25, -10, "SSR", " "),
            new Row("花蓮", 6, 10, -10, -5, "R", " "),
            new Row("花蓮", 7, 0, -15, -10, "R", " "),
            new Row("花蓮", 8, 20, -15, -5, "SR", " "),
            new Row("花蓮", 9, 15, -10, 10, "R", " "),
            new Row("花蓮", 10, 20, -15, -5, "SR", " "),
            new Row("花蓮", 11, 10, -5, 5, "R", " "),
            new Row("花蓮", 12, 50, -30, 10, "UR", " "),
            new Row("花蓮", 13, 0, 0, 1, "N", " "),
            new Row("花蓮", 14, -1, 0, 2, "N", " "),
            new Row("花蓮", 15, 5, 5, 10, "R", " "),
            new Row("花蓮", 16, 20, -15, 15, "UR", " "),
            new Row("花蓮", 17, 10, 0, 10, "SR", " "),
            new Row("花蓮", 18, -5, 0, 5, "R", " "),
            new Row("苗栗", 0, 10, 15, 10, "R", " "),
            new Row("苗栗", 1, 5, 10, 5, "N", " "),
            new Row("苗栗", 2, 5, 10, 5, "N", " "),
            new Row("苗栗", 3, 0, 15, 5, "R", " "),
            new Row("苗栗", 4, -10, -25, -20, "SSR", " "),
            new Row("苗栗", 5, 0, -20, -15, "SR", " "),
            new Row("苗栗", 6, -5, -15, -5, "R", " "),
            new Row("苗栗", 7, 5, -10, -5, "N", " "),
            new Row("苗栗", 8, 20, -15, -10, "SR", " "),
            new Row("苗栗", 9, 15, -10, 5, "R", " "),
            new Row("苗栗", 10, 10, -5, -5, "N", " "),
            new Row("苗栗", 11, 10, -5, 5, "N", " "),
            new Row("苗栗", 12, 45, 10, 20, "UR", " "),
            new Row("苗栗", 13, -1, 0, 2, "N", " "),
            new Row("金馬", 0, 0, 20, 10, "SR", " "),
            new Row("金馬", 1, 0, 15, 5, "R", " "),
            new Row("金馬", 2, 5, 10, 5, "N", " "),
            new Row("金馬", 3, 0, 10, 5, "N", " "),
            new Row("金馬", 4, -5, -20, -15, "SR", " "),
            new Row("金馬", 5, 0, -15, -10, "R", " "),
            new Row("金馬", 6, 15, -10, 5, "R", " "),
            new Row("金馬", 7, 10, -5, 5, "N", " "),
            new Row("金馬", 8, 15, -10, 5, "R", " "),
            new Row("金馬", 9, 10, 20, 15, "SR", " "),
            new Row("金馬", 10, 0, 15, 10, "R", " "),
            new Row("金馬", 11, 5, 10, 5, "N", " "),
            new Row("金馬", 12, 0, 10, 5, "N", " "),
            new Row("金馬", 13, 0, -20, -10, "SR", " "),
            new Row("金馬", 14, 0, -15, -5, "R", " "),
            new Row("金馬", 15, 0, -15, -5, "R", " "),
            new Row("金馬", 16, -5, -10, -5, "N", " "),
            new Row("金馬", 17, 0, -10, -15, "R", " "),
            new Row("金馬", 18, 15, -5, 5, "R", " "),
            new Row("金馬", 19, 50, -5, 30, "UR", " "),
            new Row("金馬", 20, -20, -10, -30, "SSR", " "),
            new Row("金馬", 21, -1, 0, 2, "N", " "),
            new Row("雲林", 0, 5, 10, 5, "N", " "),
            new Row("雲林", 1, 0, 15, 10, "R", " "),
            new Row("雲林", 2, 5, 10, 5, "N", " "),
            new Row("雲林", 3, 0, 10, 5, "N", " "),
            new Row("雲林", 4, -15, -30, -20, "SSR", " "),
            new Row("雲林", 5, -10, -20, -10, "SR", " "),
            new Row("雲林", 6, -5, -15, -10, "R", " "),
            new Row("雲林", 7, 0, -15, -5, "R", " "),
            new Row("雲林", 8, 25, -20, -10, "SSR", " "),
            new Row("雲林", 9, 15, -10, -5, "R", " "),
            new Row("雲林", 10, 10, -5, 5, "N", " "),
            new Row("雲林", 11, 5, 15, 10, "R", " "),
            new Row("雲林", 12, 40, 10, 30, "UR", " "),
            new Row("高雄", 0, 0, 15, 10, "R", " "),
            new Row("高雄", 1, 0, 15, 5, "R", " "),
            new Row("高雄", 2, 0, 10, 10, "N", " "),
            new Row("高雄", 3, 5, 10, 5, "N", " "),
            new Row("高雄", 4, -15, -30, -20, "SSR", " "),
            new Row("高雄", 5, -10, -20, -15, "SR", " "),
            new Row("高雄", 6, 0, -15, -10, "R", " "),
            new Row("高雄", 7, -5, -10, -5, "N", " "),
            new Row("高雄", 8, 25, -20, -5, "SSR", " "),
            new Row("高雄", 9, 20, -10, 5, "SR", " "),
            new Row("高雄", 10, 15, -5, 10, "R", " "),
            new Row("高雄", 11, 20, -15, -5, "SR", " "),
            new Row("高雄", 12, 50, -10, 30, "UR", " "),
            new Row("高雄", 13, -1, -1, 1, "N", " "),
        };

        public static List<CardInfo> GetCardsForCity(string city)
        {
            var result = new List<CardInfo>();

            foreach (var row in Rows)
            {
                if (row.City == city)
                {
                    var card = new CardInfo
                    {
                        Title = CardDESC.Title[city][row.Index],
                        Description = CardDESC.Desc[city][row.Index],
                        MoneyChange = row.Money,
                        EcoChange = row.Eco,
                        SocialChange = row.Social,
                        Rarity = row.Rarity,
                        ImagePath = string.IsNullOrWhiteSpace(row.ImagePath) ? null : row.ImagePath,
                        City = city   // ✅ 很重要！一定要設定
                    };

                    result.Add(card);
                }
            }

            return result;
        }
    }
}
